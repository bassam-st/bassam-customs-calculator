<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠØ©</title>
<style>
  body{font-family:'Noto Kufi Arabic',system-ui,sans-serif;background:#f1f5f9;margin:0}
  .top{background:#16a34a;color:#fff;padding:14px 16px;font-size:18px;font-weight:700;text-align:center}
  .wrap{max-width:880px;margin:16px auto;padding:0 12px}
  .card{background:#fff;border:1px solid #e5e7eb;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.05);padding:14px;margin-top:12px}
  input{width:100%;padding:12px;border:1px solid #cbd5e1;border-radius:12px;font-size:16px;background:#fff}
  .item{background:#fff;border:1px solid #e5e7eb;border-radius:12px;padding:12px;margin-top:10px;display:flex;justify-content:space-between;align-items:center}
  .info{flex:1}
  .name{font-weight:700;color:#0f172a}
  .code{font-size:13px;color:#475569;margin-top:2px}
  .btn{border:none;border-radius:10px;padding:10px 14px;font-weight:700;cursor:pointer}
  .btn-green{background:#16a34a;color:#fff}
  .muted{color:#64748b;font-size:13px}
  .nav a{display:inline-block;text-decoration:none;background:#e2e8f0;color:#0f172a;padding:8px 12px;border-radius:10px}
</style>
</head>
<body>
  <div class="top">ğŸ“‹ Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠØ©</div>
  <div class="wrap">
    <div class="nav"><a href="./index.html">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø­Ø§Ø³Ø¨Ø©</a></div>

    <div class="card">
      <input id="q" placeholder="Ø§ÙƒØªØ¨ Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©... Ù…Ø«Ø§Ù„: Ø¨Ø·Ø§Ø±ÙŠØ§ØªØŒ Ù…Ù„Ø§Ø¨Ø³ØŒ Ø±ÙˆÙ„Ø§Øª ØªØºÙ„ÙŠÙØŒ Ø´Ø¨Ùƒ Ø­Ø¯ÙŠØ¯" autofocus />
      <div class="muted" style="margin-top:6px">ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„ØµÙ†Ù Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø£Ùˆ Ø¨Ø±Ù‚Ù… Ø§Ù„Ø¨Ù†Ø¯ Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠ</div>
    </div>

    <div class="card" id="results">
      <div class="muted">Ø§Ø¨Ø¯Ø£ Ø¨Ø§Ù„ÙƒØªØ§Ø¨Ø© Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¨Ù†ÙˆØ¯...</div>
    </div>
  </div>

<script>
  const HS_URL = './assets/hs_catalog.json';
  let HS = [];

  // â€” ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª â€”
  async function loadHS(){
    try{
      const res = await fetch(HS_URL);
      HS = await res.json();
    }catch{ HS = []; }
  }

  // â€” ØªØ·Ø¨ÙŠØ¹ Ø§Ù„Ø£Ø­Ø±Ù Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© â€”
  function normalizeArabic(s){
    if(!s) return "";
    return s.replace(/[Ø£Ø¥Ø¢Ø§]/g,'Ø§')
            .replace(/Ù‰/g,'ÙŠ')
            .replace(/Ø©/g,'Ù‡')
            .replace(/[^\u0600-\u06FF0-9a-zA-Z\s]+/g,' ')
            .trim();
  }

  function matches(item, query){
    const q = normalizeArabic(query);
    const name = normalizeArabic(item.name || '');
    const code = String(item.code || '');
    return name.includes(q) || code.startsWith(q);
  }

  function render(list, query){
    const box = document.getElementById('results');
    if(!list.length){
      box.innerHTML = '<div class="muted">Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨Ù†ÙˆØ¯ Ù…Ø·Ø§Ø¨Ù‚Ø©...</div>';
      return;
    }

    box.innerHTML = list.slice(0,200).map(x => `
      <div class="item">
        <div class="info">
          <div class="name">${x.name}</div>
          <div class="code">Ø§Ù„Ø¨Ù†Ø¯ Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠ: ${x.code}</div>
        </div>
        <button class="btn btn-green" onclick="goCalc('${x.code}')">Ø§Ø³ØªØ®Ø¯Ø§Ù…</button>
      </div>
    `).join('');
  }

  function goCalc(code){
    location.href = './index.html?hs=' + code;
  }

  const q = document.getElementById('q');
  q.addEventListener('input', ()=>{
    const query = q.value.trim();
    const filtered = HS.filter(x => matches(x, query));
    render(filtered, query);
  });

  (async ()=>{
    await loadHS();
    render([], '');
  })();
</script>
</body>
</html>
