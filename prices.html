<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>أسعار السلع</title>
<style>
  body{font-family:'Noto Kufi Arabic',system-ui,sans-serif;background:#f1f5f9;margin:0}
  .top{background:#2563eb;color:#fff;padding:14px 16px}
  .wrap{max-width:720px;margin:16px auto;padding:0 12px}
  input{width:100%;padding:12px;border:1px solid #cbd5e1;border-radius:10px;background:#fff}
  .row{display:flex;justify-content:space-between;gap:10px;padding:10px;border-bottom:1px dashed #cbd5e1}
  .muted{color:#64748b;font-size:13px}
  .btn{background:#16a34a;color:#fff;border:none;border-radius:10px;padding:8px 12px;cursor:pointer}
  .nav{margin:10px 0}
  .nav a{display:inline-block;margin-left:8px;text-decoration:none;background:#e2e8f0;color:#0f172a;padding:8px 12px;border-radius:10px}
</style>
</head>
<body>
  <div class="top"><b>💲 البحث عن أسعار السلع</b></div>
  <div class="wrap">
    <div class="nav"><a href="./index.html">← العودة للحاسبة</a></div>
    <input id="q" placeholder="اكتب اسم السلعة… مثال: بطاطس، قطع غيار" />
    <div id="list" style="margin-top:10px;background:#fff;border:1px solid #e5e7eb;border-radius:10px"></div>
  </div>

<script>
  let DB=[];
  async function load(){
    try{
      const r = await fetch('./assets/prices_catalog.json');
      DB = await r.json();
    }catch(e){ DB=[]; }
  }
  function render(items){
    const box = document.getElementById('list');
    if(!items.length){ box.innerHTML = '<div class="muted" style="padding:10px">لا توجد نتائج مطابقة…</div>'; return; }
    box.innerHTML = items.slice(0,50).map(x=>`
      <div class="row">
        <div>
          <div><b>${x.name}</b></div>
          <div class="muted">${x.price} ${x.currency||'USD'}</div>
        </div>
        <button class="btn" onclick="location.href='./index.html?value=${encodeURIComponent(x.price)}'">استخدام السعر</button>
      </div>
    `).join('');
  }
  function norm(s){return (s||'').toString().trim();}
  document.getElementById('q').addEventListener('input',e=>{
    const v = norm(e.target.value);
    if(!v){ render([]); return; }
    const res = DB.filter(x=> norm(x.name).includes(v));
    render(res);
  });
  load();
</script>
</body>
</html>
