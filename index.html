<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ø¨Ø³Ø§Ù… Ø§Ù„Ø´ØªÙŠÙ…ÙŠ Ù„Ù„ØªØ®Ù„ÙŠØµ Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠ</title>

  <!-- PWA (Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ù„ÙƒÙ† ÙŠÙÙØ¶Ù‘ÙÙ„) -->
  <link rel="manifest" href="./manifest.webmanifest">
  <meta name="theme-color" content="#16a34a">
  <link rel="icon" href="./icons/icon-192.png" sizes="192x192">
  <link rel="icon" href="./icons/icon-512.png" sizes="512x512">

  <style>
    :root{
      --green:#16a34a; --green2:#22c55e; --ink:#0f172a; --muted:#64748b;
      --card:#ffffff; --bg:#f1f5f9; --accent:#2563eb;
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);font-family:'Noto Kufi Arabic',system-ui,sans-serif;color:var(--ink)}
    .wrap{max-width:720px;margin:16px auto;padding:12px}

    /* Hero */
    .hero{
      background:linear-gradient(135deg,var(--green),var(--green2));
      color:#fff;border-radius:18px;padding:18px;position:relative;
      box-shadow:0 10px 30px rgba(22,163,74,.18);
    }
    .brand{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .brand h1{margin:0;font-size:20px;line-height:1.35}
    .badge{
      background:#fff;border:2px solid #fff;color:#064e3b;
      width:56px;height:56px;display:grid;place-items:center;border-radius:14px;
      font-weight:800;
    }
    .phone{margin-top:4px;opacity:.95;font-size:13px}
    .nav{display:flex;gap:8px;flex-wrap:wrap;margin:8px 0 0}
    .nav a{background:#e2e8f0;color:#0f172a;text-decoration:none;padding:8px 12px;border-radius:10px;font-weight:700}
    .pwa-bar{margin-top:10px}
    .btn{border:none;border-radius:10px;padding:10px 12px;font-weight:800;cursor:pointer}
    .btn-blue{background:var(--accent);color:#fff}
    .btn-gray{background:#e2e8f0;color:#0f172a}

    /* Cards */
    .card{background:var(--card);border-radius:14px;padding:16px;margin-top:12px;
          box-shadow:0 8px 24px rgba(0,0,0,.06);border:1px solid #e5e7eb}

    /* Calculator */
    label{display:block;font-weight:700;margin-bottom:6px}
    input[type="number"]{
      width:100%;padding:14px 16px;border:1px solid #cbd5e1;border-radius:12px;
      font-size:18px;background:#fff;outline:none
    }
    .hint{font-size:12px;color:#0f5132;opacity:.9;margin-top:6px}
    .rates{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .pill{
      display:flex;align-items:center;gap:10px;
      padding:10px 14px;border-radius:999px;border:2px solid #cbead9;background:#f0fdf4;
      cursor:pointer;font-weight:800;color:#14532d
    }
    .pill input{appearance:none;width:20px;height:20px;border:2px solid #84d1b0;border-radius:50%}
    .pill.active{background:#14532d;color:#fff;border-color:#14532d}
    .pill.active input{border-color:#fff;box-shadow:inset 0 0 0 6px #fff;background:#fff}

    .hs-badge{display:inline-block;background:#ecfeff;border:1px solid #a5f3fc;color:#155e75;
              border-radius:999px;padding:4px 10px;font-size:12px;margin-top:8px}

    .result{
      border:2px dashed #cbd5e1;border-radius:14px;padding:16px;background:#f8fafc;margin-top:12px;
      text-align:center
    }
    .result .big{font-size:38px;font-weight:900;color:#065f46;letter-spacing:.5px}
    .result .mini{margin-top:8px;color:var(--muted);font-size:13px}
    .actions{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:12px}
    .btn.copy{background:#22c55e;color:#fff}
    .btn.pdf{background:var(--accent);color:#fff}
    .btn.wa{background:#16a34a;color:#fff}

    @media (max-width:420px){ .result .big{font-size:32px} }
  </style>
</head>
<body>
  <div class="wrap">
    <!-- Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø© -->
    <section class="hero">
      <div class="brand">
        <h1>Ø¨Ø³Ø§Ù… Ø§Ù„Ø´ØªÙŠÙ…ÙŠ Ù„Ù„ØªØ®Ù„ÙŠØµ Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠ</h1>
        <div class="badge">Ø¨Ø´</div>
      </div>
      <div class="phone">Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø± ÙˆØ®Ø¯Ù…Ø§Øª Ø§Ù„ØªØ®Ù„ÙŠØµ: <b>00967771997809</b></div>
      <div class="nav">
        <a href="./prices.html">ğŸ’² Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</a>
        <a href="./hs.html">ğŸ” Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠØ©</a>
      </div>

      <!-- Ø²Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª (PWA) -->
      <div class="pwa-bar">
        <button id="installBtn" class="btn btn-blue" style="display:none">â¬‡ï¸ ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</button>
        <button id="openAppBtn" class="btn btn-gray" style="display:none">ÙØªØ­ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</button>
      </div>
    </section>

    <!-- Ø§Ù„Ø­Ø§Ø³Ø¨Ø© -->
    <section class="card">
      <label for="usd">Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³Ù„Ø¹Ø© (Ø¨Ø§Ù„Ø¯ÙˆÙ„Ø§Ø± USD)</label>
      <input id="usd" type="number" inputmode="decimal" placeholder="Ù…Ø«Ø§Ù„: 2000" />

      <div class="rates" style="margin-top:8px">
        <label class="pill active" id="pill5">
          <input type="radio" name="rate" value="0.2075" checked />
          <span>5% (Ø¹Ø§Ù…Ù„ 0.2075)</span>
        </label>
        <label class="pill" id="pill10">
          <input type="radio" name="rate" value="0.265" />
          <span>10% (Ø¹Ø§Ù…Ù„ 0.265)</span>
        </label>
      </div>

      <div id="hsBadge" class="hs-badge" style="display:none"></div>

      <div class="result">
        <div class="big" id="out">0</div>
        <div class="mini" id="formula">0 Ã— 750 Ã— 0 = 0</div>
      </div>

      <div class="actions">
        <button class="btn pdf"  onclick="window.print()">Ø·Ø¨Ø§Ø¹Ø© / Ø­ÙØ¸ PDF</button>
        <button class="btn copy" onclick="copyResult()">Ù†Ø³Ø® Ø§Ù„Ù†ØªÙŠØ¬Ø©</button>
        <button class="btn wa"   onclick="shareWhatsApp()">Ù…Ø´Ø§Ø±ÙƒØ© ÙˆØ§ØªØ³Ø§Ø¨</button>
      </div>

      <div class="hint">Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„Ø©: Ø§Ù„Ø±Ø³ÙˆÙ… = Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³Ù„Ø¹Ø© Ã— 750 Ã— Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„ÙØ¦Ø©</div>
    </section>
  </div>

<script>
  // ===== Ø§Ù„Ø­Ø§Ø³Ø¨Ø© =====
  const usd   = document.getElementById('usd');
  const out   = document.getElementById('out');
  const formula = document.getElementById('formula');
  const rateRadios = Array.from(document.querySelectorAll('input[name="rate"]'));
  const pills = [document.getElementById('pill5'), document.getElementById('pill10')];
  const enFmt = new Intl.NumberFormat('en-US');

  rateRadios.forEach((r,i)=>{
    r.addEventListener('change',()=>{
      pills.forEach(p=>p.classList.remove('active'));
      pills[i].classList.add('active');
      calc();
    });
  });
  usd.addEventListener('input', calc);

  function getRate(){
    const r = rateRadios.find(x=>x.checked);
    return r ? parseFloat(r.value) : 0.2075;
  }
  function calc(){
    const v = parseFloat(usd.value || 0);
    const rate = getRate();
    const result = v * 750 * rate;
    out.textContent = enFmt.format(Math.round(result));
    const f = `${enFmt.format(v)} Ã— 750 Ã— ${rate} = ${enFmt.format(Math.round(result))}`;
    formula.textContent = f;
  }
  function copyResult(){
    const text = `Estimated customs duty: ${out.textContent} Yemeni Rial`;
    navigator.clipboard.writeText(text).then(()=>alert('âœ” Copied'));
  }
  function shareWhatsApp(){
    const msg = `Estimated customs duty: ${out.textContent} Yemeni Rial`;
    open(`https://wa.me/?text=${encodeURIComponent(msg)}`,'_blank');
  }

  // ===== Ø¯Ø¹Ù… Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù‚Ø§Ø¯Ù…Ø© Ù…Ù† Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰ =====
  const params = new URLSearchParams(location.search);
  // Ù‚ÙŠÙ…Ø© Ù…Ù† Ø§Ù„Ø£Ø³Ø¹Ø§Ø± ?value=...
  if (params.has('value')) usd.value = params.get('value');
  // ÙØ¦Ø© Ù…Ù† Ø§Ù„Ø£Ø³Ø¹Ø§Ø± ?rate=5 Ø£Ùˆ 10
  if (params.has('rate')) {
    const r = params.get('rate'); // "5" Ø£Ùˆ "10"
    const targetVal = (r === "10") ? "0.265" : "0.2075";
    const radio = document.querySelector(`input[name="rate"][value="${targetVal}"]`);
    if (radio) {
      radio.checked = true;
      pills.forEach(p=>p.classList.remove('active'));
      (r==="10" ? pills[1] : pills[0]).classList.add('active');
    }
  }
  // ÙƒÙˆØ¯ Ø¨Ù†Ø¯ HS Ù…Ù† ØµÙØ­Ø© Ø§Ù„Ø¨Ù†ÙˆØ¯ ?hs=
  const hsBadge = document.getElementById('hsBadge');
  if (params.has('hs')) {
    const hs = decodeURIComponent(params.get('hs'));
    hsBadge.textContent = `Ø§Ù„Ø¨Ù†Ø¯: ${hs}`;
    hsBadge.style.display = '';
  }

  calc();

  // ===== Ø²Ø± ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ (PWA) =====
  let deferredPrompt = null;
  const installBtn = document.getElementById('installBtn');
  const openAppBtn = document.getElementById('openAppBtn');

  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    installBtn.style.display = 'inline-block';
  });

  installBtn.addEventListener('click', async () => {
    if (!deferredPrompt) return;
    deferredPrompt.prompt();
    const { outcome } = await deferredPrompt.userChoice;
    if (outcome === 'accepted') {
      installBtn.style.display = 'none';
      openAppBtn.style.display = 'inline-block';
    }
    deferredPrompt = null;
  });

  openAppBtn.addEventListener('click', ()=>{
    // Ù…Ø¬Ø±Ø¯ Ù…Ø­Ø§ÙˆÙ„Ø© ÙØªØ­ Ø§Ù„ØªØ«Ø¨ÙŠØª/Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø«Ø¨Øª
    alert('Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ù…ÙØ«Ø¨Ù‘ØªÙ‹Ø§ Ø³ÙŠØ¸Ù‡Ø± Ù…Ù† Ø§Ù„Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©.');
  });

  // ØªØ³Ø¬ÙŠÙ„ Service Worker Ø¥Ù† ÙˆÙØ¬Ø¯ Ø§Ù„Ù…Ù„Ù
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./sw.js').catch(()=>{});
  }
</script>
</body>
</html>
