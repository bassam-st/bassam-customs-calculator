<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ø¨Ø³Ø§Ù… Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠ</title>

<!-- PWA Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª -->
<link rel="manifest" href="/manifest.json">
<meta name="theme-color" content="#16a34a">
<link rel="icon" href="/Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª/icon-192.png">

<style>
  :root{
    --green:#16a34a; --green2:#22c55e; --ink:#0f172a; --muted:#64748b;
    --card:#ffffff; --bg:#f1f5f9; --accent:#2563eb;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);font-family:'Noto Kufi Arabic',system-ui,sans-serif;color:var(--ink)}
  .wrap{max-width:720px;margin:16px auto;padding:12px}

  /* Ø§Ù„Ø¹Ù†ÙˆØ§Ù† */
  .hero{
    background:linear-gradient(135deg,var(--green),var(--green2));
    color:#fff;border-radius:24px;padding:22px 18px;position:relative;
    box-shadow:0 10px 30px rgba(22,163,74,.18);
  }
  .brand{display:flex;align-items:center;justify-content:space-between;gap:12px}
  .brand h1{margin:0;font-size:22px;line-height:1.35}
  .badge{
    background:#fff;border:2px solid #fff;color:#064e3b;
    width:64px;height:64px;display:grid;place-items:center;border-radius:18px;
    font-weight:800;
  }
  .phone{margin-top:6px;opacity:.95;font-size:14px}
  .nav{display:flex;gap:8px;flex-wrap:wrap;margin:10px 0 0}
  .nav a{background:#e2e8f0;color:#0f172a;text-decoration:none;padding:8px 12px;border-radius:10px;font-weight:700}

  /* ÙƒØ§Ø±Øª Ø§Ù„ØªØ­ÙƒÙ… */
  .card{background:var(--card);border-radius:18px;padding:16px;margin-top:16px;
        box-shadow:0 8px 24px rgba(0,0,0,.06);border:1px solid #e5e7eb}
  .owner{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .owner small{color:var(--muted)}
  .owner input[type=password]{padding:10px 12px;border:1px solid #cbd5e1;border-radius:10px}
  .btn{border:none;border-radius:12px;padding:10px 14px;font-weight:800;cursor:pointer}
  .btn-blue{background:var(--accent);color:#fff}
  .btn-gray{background:#e2e8f0;color:#0f172a}
  .owner-on{color:#065f46;font-weight:800}

  /* Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª */
  .presets{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
  .chip{background:#e6f7ef;color:#14532d;border:1px solid #bbf7d0;padding:8px 10px;border-radius:999px;cursor:pointer}
  .chip .x{margin-inline-start:8px;cursor:pointer;color:#b91c1c;display:none}
  .chip.admin .x{display:inline}

  /* Ø§Ù„Ø¢Ù„Ø© Ø§Ù„Ø­Ø§Ø³Ø¨Ø© */
  label{display:block;font-weight:700;margin-bottom:6px}
  input[type="number"]{
    width:100%;padding:14px 16px;border:1px solid #cbd5e1;border-radius:14px;
    font-size:18px;background:#fff;outline:none
  }
  .group-title{margin:16px 0 8px;font-weight:700;color:#334155}
  .rates{display:flex;flex-direction:column;gap:12px}
  .pill{
    display:flex;align-items:center;justify-content:space-between;gap:10px;
    padding:14px;border-radius:999px;border:2px solid #cbead9;
    background:#f0fdf4;cursor:pointer
  }
  .pill input{appearance:none;width:22px;height:22px;border:2px solid #84d1b0;border-radius:50%;margin:0}
  .pill.active{background:#14532d;color:#fff;border-color:#14532d}
  .pill.active input{border-color:#fff;box-shadow:inset 0 0 0 6px #fff;background:#fff}
  .hint{font-size:13px;color:#0f5132;opacity:.9}
  .result{
    border:2px dashed #cbd5e1;border-radius:18px;padding:18px;background:#f8fafc;margin-top:8px;
    text-align:center
  }
  .result .big{font-size:42px;font-weight:900;color:#065f46;letter-spacing:1px}
  .result .mini{margin-top:8px;color:var(--muted)}
  .actions{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:16px}
  .btn.copy{background:#22c55e;color:#fff}
  .btn.pdf{background:var(--accent);color:#fff}
  .btn.wa{background:#16a34a;color:#fff}
  @media (max-width:420px){ .result .big{font-size:36px} }

  /* Ø²Ø± ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ */
  #installBtn{
    position:fixed; bottom:16px; inset-inline:16px; z-index:9999;
    background:#16a34a; color:#fff; border:none; border-radius:14px;
    padding:12px 16px; font-weight:900; display:none; box-shadow:0 8px 20px rgba(22,163,74,.25);
  }
</style>
</head>
<body>
  <div class="wrap">
    <!-- Ø§Ù„Ø¹Ù†ÙˆØ§Ù† -->
    <section class="hero">
      <div class="brand">
        <h1>Ø¨Ø³Ø§Ù… Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠ</h1>
        <div class="badge">ğŸ’¼</div>
      </div>
      <div class="phone">Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø± ÙˆØ®Ø¯Ù…Ø§Øª Ø§Ù„ØªØ®Ù„ÙŠØµ: <b>00967771997809</b></div>
      <div class="nav">
        <a href="./prices.html">ğŸ’² Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</a>
        <a href="./hs.html">ğŸ” Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠØ©</a>
      </div>
      <div class="presets" id="presets"></div>
    </section>

    <!-- ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø§Ù„Ùƒ -->
    <section class="card">
      <div class="owner">
        <span>ğŸ”’ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø§Ù„Ùƒ:</span>
        <input id="pin" type="password" placeholder="PIN" />
        <button class="btn btn-blue" id="unlock">ÙØªØ­</button>
        <button class="btn btn-gray" id="lock">Ù‚ÙÙ„</button>
        <small id="state">Ø§Ù„Ø­Ø§Ù„Ø©: Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø·</small>
      </div>

      <!-- Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø£Ø³Ø¹Ø§Ø± -->
      <div id="adminForm" style="display:none;margin-top:10px">
        <div class="owner" style="gap:10px">
          <input id="pName" placeholder="Ø§Ø³Ù… Ø§Ù„Ø³Ù„Ø¹Ø©â€¦" />
          <input id="pVal" type="number" inputmode="decimal" placeholder="Ø§Ù„Ù‚ÙŠÙ…Ø© Ø¨Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±â€¦" />
          <select id="pUnit">
            <option value="pcs">Ø­Ø¨Ø©</option>
            <option value="ton">Ø·Ù†</option>
            <option value="dz">Ø¯Ø±Ø²Ù†</option>
            <option value="kw">ÙƒÙŠÙ„ÙˆÙˆØ§Øª</option>
            <option value="ah">Ø£Ù…Ø¨ÙŠØ±/Ø³Ø§Ø¹Ø©</option>
          </select>
          <button class="btn btn-blue" id="addPreset">Ø¥Ø¶Ø§ÙØ©</button>
          <button class="btn btn-gray" id="clearPresets">ØªÙØ±ÙŠØº Ø§Ù„ÙƒÙ„</button>
        </div>
        <small class="owner-on">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªØ­ÙØ¸ Ù…Ø­Ù„ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„Ù…ØªØµÙØ­ ÙˆÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„Ù‡Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹.</small>
      </div>
    </section>

    <!-- Ø§Ù„Ø¢Ù„Ø© Ø§Ù„Ø­Ø§Ø³Ø¨Ø© -->
    <section class="card">
      <label for="usd">Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³Ù„Ø¹Ø© (Ø¨Ø§Ù„Ø¯ÙˆÙ„Ø§Ø± USD)</label>
      <input id="usd" type="number" inputmode="decimal" placeholder="Ù…Ø«Ø§Ù„: 2000" />

      <div class="group-title">Ø§Ø®ØªØ± Ø§Ù„ÙØ¦Ø© Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠØ©</div>
      <div class="rates">
        <label class="pill" id="pill5">
          <div><b>5%</b> <span class="hint">(ÙØ¦Ø© Ø®Ù…Ø³Ø© Ø¨Ø§Ù„Ù…Ø¦Ø©)</span></div>
          <input type="radio" name="rate" value="0.2075" />
        </label>
        <label class="pill active" id="pill10">
          <div><b>10%</b> <span class="hint">(ÙØ¦Ø© Ø¹Ø´Ø±Ø© Ø¨Ø§Ù„Ù…Ø¦Ø©)</span></div>
          <input type="radio" name="rate" value="0.265" checked />
        </label>
      </div>

      <div class="group-title">Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠØ© (Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ)</div>
      <div class="result">
        <div class="big" id="out">0</div>
        <div class="mini" id="formula">0 Ã— 750 Ã— 0 = 0</div>
      </div>

      <div class="actions">
        <button class="btn pdf"  onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© / PDF</button>
        <button class="btn copy" onclick="copyResult()">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ù†ØªÙŠØ¬Ø©</button>
        <button class="btn wa"   onclick="shareWhatsApp()">ğŸ“² ÙˆØ§ØªØ³Ø§Ø¨</button>
      </div>
    </section>
  </div>

  <!-- Ø²Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª -->
  <button id="installBtn">â¤µï¸ ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</button>

<script>
  // âœ… ØªØ³Ø¬ÙŠÙ„ Service Worker
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/sw.js');
  }

  // ğŸ”½ Ø²Ø± Ø§Ù„ØªØ«Ø¨ÙŠØª
  let deferredPrompt;
  const installBtn = document.getElementById('installBtn');
  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    installBtn.style.display = 'block';
  });
  installBtn.addEventListener('click', async () => {
    installBtn.style.display = 'none';
    deferredPrompt.prompt();
    await deferredPrompt.userChoice;
    deferredPrompt = null;
  });

  // ğŸ”’ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø§Ù„Ùƒ
  const ADMIN_PIN = "bassam1234";
  let isOwner = false;
  const pin = document.getElementById('pin');
  const unlock = document.getElementById('unlock');
  const lock = document.getElementById('lock');
  const state = document.getElementById('state');
  const adminForm = document.getElementById('adminForm');

  function updateOwnerUI(){
    state.textContent = 'Ø§Ù„Ø­Ø§Ù„Ø©: ' + (isOwner ? 'Ù…Ø§Ù„Ùƒ (ØªØ­Ø±ÙŠØ± Ù…ÙØ¹Ù‘Ù„)' : 'Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø·');
    adminForm.style.display = isOwner ? '' : 'none';
    renderPresets();
  }

  unlock.addEventListener('click', ()=>{
    if(pin.value === ADMIN_PIN){ isOwner=true; updateOwnerUI(); alert('âœ… ØªÙ… ÙØªØ­ ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø§Ù„Ùƒ'); }
    else alert('âŒ Ø±Ù…Ø² ØºÙŠØ± ØµØ­ÙŠØ­');
  });
  lock.addEventListener('click', ()=>{ isOwner=false; updateOwnerUI(); });

  // ğŸ’¾ Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª
  const PRESETS_KEY = 'customQuickPresetsV2';
  const pName = document.getElementById('pName');
  const pVal  = document.getElementById('pVal');
  const pUnit = document.getElementById('pUnit');
  const addPresetBtn = document.getElementById('addPreset');
  const clearPresetsBtn = document.getElementById('clearPresets');
  const presetsEl = document.getElementById('presets');

  function loadPresets(){ try{ return JSON.parse(localStorage.getItem(PRESETS_KEY))||[] }catch{ return [] } }
  function savePresets(arr){ localStorage.setItem(PRESETS_KEY, JSON.stringify(arr)) }

  addPresetBtn.addEventListener('click', ()=>{
    if(!isOwner) return alert('Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ù„Ù…Ø§Ù„Ùƒ ÙÙ‚Ø·');
    const name = (pName.value||'').trim();
    const val  = parseFloat(pVal.value||0);
    const unit = pUnit.value;
    if(!name || !val) return alert('Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£ÙˆÙ„Ø§Ù‹');
    const arr = loadPresets();
    const i = arr.findIndex(x=>x.name===name);
    if(i>=0){ arr[i].value=val; arr[i].unit=unit; }
    else { arr.push({name, value: val, unit}); }
    savePresets(arr);
    pName.value=''; pVal.value='';
    renderPresets();
  });

  clearPresetsBtn.addEventListener('click', ()=>{
    if(!isOwner) return alert('Ù„Ù„Ù…Ø§Ù„Ùƒ ÙÙ‚Ø·');
    if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø³Ø¹Ø§Ø±ØŸ')){ savePresets([]); renderPresets(); }
  });

  function renderPresets(){
    const arr = loadPresets();
    if(!arr.length){ presetsEl.innerHTML=''; return; }
    presetsEl.innerHTML = arr.map(x=>(
      `<span class="chip ${isOwner?'admin':''}" onclick="fillValue(${x.value})">
         ${x.name} (${x.unit}) â€“ ${x.value}$
         ${isOwner?`<span class='x' onclick="event.stopPropagation(); delPreset('${x.name}')">Ã—</span>`:''}
       </span>`
    )).join('');
  }

  window.fillValue = v => { usd.value=v; calc(); window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'}); }
  window.delPreset = name => { if(isOwner){ savePresets(loadPresets().filter(x=>x.name!==name)); renderPresets(); } }

  // ğŸ’° Ø§Ù„Ø­Ø§Ø³Ø¨Ø©
  const usd = document.getElementById('usd');
  const out = document.getElementById('out');
  const formula = document.getElementById('formula');
  const rateRadios = Array.from(document.querySelectorAll('input[name="rate"]'));
  const pills = [document.getElementById('pill5'), document.getElementById('pill10')];
  const enFmt = new Intl.NumberFormat('en-US');

  rateRadios.forEach((r,i)=>{
    r.addEventListener('change',()=>{
      pills.forEach(p=>p.classList.remove('active'));
      pills[i].classList.add('active');
      calc();
    });
  });

  usd.addEventListener('input', calc);
  function getRate(){ const r=rateRadios.find(x=>x.checked); return r?parseFloat(r.value):0.2075; }
  function calc(){
    const v=parseFloat(usd.value||0), rate=getRate();
    const result=v*750*rate;
    out.textContent=enFmt.format(Math.round(result));
    formula.textContent=`${enFmt.format(v)} Ã— 750 Ã— ${rate} = ${enFmt.format(Math.round(result))}`;
  }

  function copyResult(){ navigator.clipboard.writeText(`Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠØ©: ${out.textContent} Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ`).then(()=>alert('âœ” ØªÙ… Ø§Ù„Ù†Ø³Ø®')); }
  function shareWhatsApp(){ open(`https://wa.me/?text=${encodeURIComponent('Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠØ©: '+out.textContent+' Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ')}`,'_blank'); }

  renderPresets(); updateOwnerUI(); calc();
</script>
</body>
</html>
