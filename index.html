<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¨Ø³Ù‘Ø§Ù… Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠ</title>
<link rel="manifest" href="/manifest.json">
<style>
  body{font-family:'Noto Kufi Arabic',system-ui,sans-serif;background:#f6f7fb;margin:0}
  .hero{background:#16a34a;color:#fff;padding:18px;border-radius:18px;margin:14px}
  .hero h1{margin:0 0 6px;font-size:20px}
  .wrap{max-width:880px;margin:0 auto;padding:0 12px}
  .row{display:grid;gap:10px}
  .card{background:#fff;border:1px solid #e5e7eb;border-radius:14px;box-shadow:0 4px 12px rgba(0,0,0,.05);padding:14px;margin:12px 0}
  label{display:block;font-size:13px;color:#475569;margin-bottom:6px}
  input,select{width:100%;padding:12px;border:1px solid #cbd5e1;border-radius:10px;background:#fff;font-size:15px}
  .btn{border:none;border-radius:10px;padding:10px 14px;font-weight:700;cursor:pointer}
  .btn-green{background:#16a34a;color:#fff}
  .btn-gray{background:#e2e8f0}
  .pill{display:flex;align-items:center;justify-content:space-between;border:1px solid #cbd5e1;border-radius:999px;padding:10px 14px;margin:8px 0}
  .pill.active{background:#e8fff0;border-color:#16a34a}
  .result{border:2px dashed #cbd5e1;border-radius:14px;padding:18px;text-align:center}
  .result .big{font-size:44px;color:#065f46;font-weight:900;margin:0}
  .muted{color:#64748b;font-size:12px}
  .bar{display:flex;gap:8px;flex-wrap:wrap}
  .nav-grid{display:flex;gap:10px;flex-wrap:wrap}
  .nav-grid a{display:inline-block;text-decoration:none;background:#e2e8f0;color:#0f172a;padding:10px 12px;border-radius:10px;font-weight:700}
  .lock-hint{font-size:12px;color:#475569;margin-top:6px}
</style>
</head>
<body>
<div class="wrap">
  <div class="hero">
    <h1>Ø¨Ø³Ù‘Ø§Ù… Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠ</h1>
    <div class="nav-grid">
      <a href="./prices.html">$ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</a>
      <a href="./items.html">ğŸ” Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠØ©</a>
      <button id="installBtn" class="btn btn-gray">â¬‡ï¸ ØªØ«Ø¨ÙŠØª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚</button>
    </div>
    <div style="margin-top:8px">Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø±: 00967771997809</div>
  </div>

  <!-- ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø§Ù„Ùƒ -->
  <div class="card">
    <label>ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø§Ù„Ùƒ: <span class="muted">Ø£Ø¯Ø®Ù„ PIN Ù„ÙØªØ­ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø¹Ù„Ù‰ Ø§Ù„ÙØ¦Ø© Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠØ©</span></label>
    <div class="bar">
      <input id="pin" placeholder="PIN">
      <button id="unlock" class="btn btn-green">ÙØªØ­</button>
      <button id="lock"   class="btn btn-gray">Ù‚ÙÙ„</button>
    </div>
    <div id="state" class="lock-hint">Ø§Ù„Ø­Ø§Ù„Ø©: Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø·</div>
  </div>

  <!-- Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ù„Ø¹Ø© (ØªÙÙ…Ù„Ø£ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„Ù‚Ø¯ÙˆÙ… Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ø¹Ø§Ø±) -->
  <div class="card">
    <div class="row">
      <div>
        <label>Ø§Ø³Ù… Ø§Ù„Ø³Ù„Ø¹Ø©</label>
        <input id="itemName" placeholder="Ø§Ø®ØªÙŠØ§Ø±ÙŠ â€“ ÙŠÙÙ…Ù„Ø£ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¹Ù†Ø¯ Ø§Ù„Ù‚Ø¯ÙˆÙ… Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ø¹Ø§Ø±">
      </div>
      <div>
        <label>Ø§Ù„ÙˆØ­Ø¯Ø©</label>
        <input id="unitLabel" placeholder="Ù…Ø«Ø§Ù„: Ù„Ù„Ø­Ø¨Ø© / Ù„Ù„Ø·Ù†">
      </div>
    </div>

    <div class="row" style="margin-top:8px">
      <div>
        <label>Ø§Ù„Ø³Ø¹Ø± Ù„Ù„ÙˆØ­Ø¯Ø© (USD)</label>
        <input id="unitPrice" type="number" inputmode="decimal" placeholder="Ù…Ø«Ø§Ù„: 15">
      </div>
      <div>
        <label>Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ÙƒÙ„ÙŠ</label>
        <input id="qty" type="number" inputmode="numeric" placeholder="Ù…Ø«Ø§Ù„: 20" value="1">
      </div>
      <div>
        <label>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³Ù„Ø¹Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© (USD)</label>
        <input id="usd" placeholder="ÙŠÙØ­Ø³Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ = Ø³Ø¹Ø± Ã— Ø¹Ø¯Ø¯ â€” ÙˆÙŠÙ…ÙƒÙ† Ø§Ù„ÙƒØªØ§Ø¨Ø© ÙŠØ¯ÙˆÙŠÙ‘Ø§Ù‹">
      </div>
    </div>

    <div class="row" style="margin-top:8px">
      <div>
        <label>Ø³Ø¹Ø± Ø§Ù„ØµØ±Ù (Ø±ÙŠØ§Ù„/Ø¯ÙˆÙ„Ø§Ø±)</label>
        <input id="fxInput" type="number" inputmode="decimal" value="750">
      </div>
    </div>
  </div>

  <!-- Ø§Ù„ÙØ¦Ø© Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠØ© (ØªÙÙ‚ÙÙ„ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØªÙÙØªØ­ Ù…Ø¹ PIN) -->
  <div class="card">
    <label>Ø§Ù„ÙØ¦Ø© Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠØ©</label>

    <label class="pill"><span>5% (ÙØ¦Ø© Ø®Ù…Ø³Ø© Ø¨Ø§Ù„Ù…Ø¦Ø©)</span>
      <input type="radio" name="rate" value="0.05">
    </label>

    <label class="pill"><span>10% (ÙØ¦Ø© Ø¹Ø´Ø±Ø© Ø¨Ø§Ù„Ù…Ø¦Ø©)</span>
      <input type="radio" name="rate" value="0.10">
    </label>

    <label class="pill"><span>Ù…Ø®ØµÙ‘Øµ</span>
      <input type="radio" name="rate" value="custom">
    </label>
    <input id="rateCustom" type="number" inputmode="decimal" placeholder="Ø£Ø¯Ø®Ù„ Ù†Ø³Ø¨Ø© Ù…Ø«Ù„ 0.08" disabled>
    <div class="muted">âš ï¸ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¹Ø§Ø¯ÙŠ: Ù‡Ø°Ù‡ Ø§Ù„ÙØ¦Ø© ØªÙØ­Ø¯Ù‘ÙØ¯ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø£Ø³Ø¹Ø§Ø± ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„Ù‡Ø§. ØªÙÙØªØ­ ÙÙ‚Ø· Ø¨ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø§Ù„Ùƒ.</div>
  </div>

  <!-- Ø§Ù„Ù†ØªÙŠØ¬Ø© -->
  <div class="card">
    <div class="result">
      <h2 class="big" id="out">0</h2>
      <div id="formula" class="muted">0 = 0.2075 Ã— 750 Ã— 0</div>
    </div>
    <div class="bar" style="margin-top:10px">
      <button class="btn btn-gray" onclick="copyResult()">Ù†Ø³Ø® Ø§Ù„Ù†ØªÙŠØ¬Ø©</button>
      <button class="btn btn-green" onclick="shareWhatsApp()">Ù…Ø´Ø§Ø±ÙƒØ© ÙˆØ§ØªØ³Ø§Ø¨</button>
    </div>
  </div>
</div>

<script src="./main.js"></script>
<script>
// Ù…Ù„Ø¡ Ø§Ù„Ø­Ù‚ÙˆÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ù…Ù† prices.html
(function fromQuery(){
  const params = new URLSearchParams(location.search);
  const name = params.get('name') || '';
  const unit = params.get('unit') || '';
  const price = parseFloat(params.get('price') || '0');
  const qty   = parseFloat(params.get('qty')   || '1');
  const rateQ = params.get('rate'); // Ù‚Ø¯ ØªÙƒÙˆÙ† "5", "5%", "0.05", "10",...

  const itemName  = document.getElementById('itemName');
  const unitLabel = document.getElementById('unitLabel');
  const unitPrice = document.getElementById('unitPrice');
  const qtyEl     = document.getElementById('qty');
  const usd       = document.getElementById('usd');

  if (name) itemName.value = name;
  if (unit) unitLabel.value = unit;
  if (!isNaN(price) && price>0) unitPrice.value = String(price);
  if (!isNaN(qty) && qty>0) qtyEl.value = String(qty);

  // Ø§Ø­Ø³Ø¨ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§
  const total = (!isNaN(price)&&!isNaN(qty)) ? price*qty : 0;
  if (total>0) usd.value = String(total);

  // Ø§Ø¶Ø¨Ø· Ø§Ù„ÙØ¦Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ ÙˆØ§Ù‚ÙÙ„Ù‡Ø§ (Ù„ØºÙŠØ± Ø§Ù„Ù…Ø§Ù„Ùƒ)
  const r = window.normalizeRate(rateQ); // 0.05 / 0.10
  if (r) window.applyRate(r, /*lockForUser=*/true);

  // Ø­Ø¯Ø« Ø§Ù„Ø¢Ù„Ø© Ø§Ù„Ø­Ø§Ø³Ø¨Ø© Ø£ÙˆÙ„ Ù…Ø±Ø©
  window.calc();
})();

// Ø±Ø¨Ø· ØªØºÙŠÙŠØ± Ø§Ù„Ø³Ø¹Ø±/Ø§Ù„Ø¹Ø¯Ø¯ Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§
document.getElementById('unitPrice').addEventListener('input', syncUSD);
document.getElementById('qty').addEventListener('input', syncUSD);
function syncUSD(){
  const p = parseFloat(document.getElementById('unitPrice').value || '0');
  const q = parseFloat(document.getElementById('qty').value || '0');
  const usd = document.getElementById('usd');
  usd.value = (isFinite(p) && isFinite(q)) ? String(p*q) : '';
  window.calc();
}
</script>
</body>
</html>
