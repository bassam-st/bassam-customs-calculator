<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Ø¨Ø³Ø§Ù… Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠ</title>
<link rel="manifest" href="manifest.json" />
<style>
  body{font-family:'Noto Kufi Arabic',system-ui,sans-serif;margin:0;background:#f9fafb;color:#0f172a}
  .head{background:#16a34a;color:#fff;padding:16px;text-align:center;font-weight:700}
  .container{max-width:720px;margin:auto;padding:20px}
  input,select{width:100%;padding:10px;margin-top:6px;margin-bottom:14px;border:1px solid #d1d5db;border-radius:10px;font-size:15px}
  .pill-group{display:flex;gap:10px;justify-content:center;margin-bottom:20px}
  .pill{border:1px solid #16a34a;border-radius:999px;padding:10px 18px;cursor:pointer}
  .pill.active{background:#16a34a;color:#fff}
  .btn{border:none;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:700}
  .btn-blue{background:#2563eb;color:#fff}
  .btn-green{background:#16a34a;color:#fff}
  .btn-gray{background:#e5e7eb;color:#0f172a}
  .result{background:#fff;border:2px dashed #16a34a;border-radius:12px;text-align:center;padding:20px;font-size:22px;font-weight:bold;margin-top:16px}
  .muted{color:#64748b;font-size:13px;text-align:center}
</style>
</head>
<body>
  <div class="head">
    Ø¨Ø³Ø§Ù… Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠ<br>
    <small>Ù„Ù„Ø§Ø³ØªÙØ³Ø§Ø± ÙˆØ®Ø¯Ù…Ø§Øª Ø§Ù„ØªØ®Ù„ÙŠØµ: 00967771997809</small>
  </div>

  <div class="container">
    <div style="text-align:center;margin-bottom:10px">
      <a href="./prices.html" class="btn btn-green">ğŸ’² Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ø¹Ø§Ø±</a>
      <a href="./items.html" class="btn btn-gray">ğŸ” Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠØ©</a>
    </div>

    <h3>Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³Ù„Ø¹Ø©</h3>
    <label>Ø§Ø³Ù… Ø§Ù„Ø³Ù„Ø¹Ø©</label>
    <input id="name" placeholder="Ø§Ø®ØªÙŠØ§Ø±ÙŠ â€“ ÙŠÙÙ…Ù„Ø£ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ Ø¹Ù†Ø¯ Ø§Ù„Ù‚Ø¯ÙˆÙ… Ù…Ù† Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ø³Ø¹Ø§Ø±" />

    <label>Ø§Ù„ÙˆØ­Ø¯Ø©</label>
    <input id="unit" placeholder="Ù…Ø«Ø§Ù„: Ù„Ù„Ø­Ø¨Ø© / Ù„Ù„Ø·Ù†" />

    <label>Ø§Ù„Ø³Ø¹Ø± Ù„Ù„ÙˆØ­Ø¯Ø© (USD)</label>
    <input id="pricePerUnit" type="number" inputmode="decimal" placeholder="Ù…Ø«Ø§Ù„: 15" />

    <label>Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„ÙƒÙ„ÙŠ</label>
    <input id="qty" type="number" inputmode="decimal" placeholder="Ù…Ø«Ø§Ù„: 1" />

    <label>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³Ù„Ø¹Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ© (USD)</label>
    <input id="usd" type="number" inputmode="decimal" placeholder="ÙŠÙØ­Ø³Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§ = Ø³Ø¹Ø± Ã— Ø¹Ø¯Ø¯" />

    <label>Ø³Ø¹Ø± Ø§Ù„ØµØ±Ù (Ø±ÙŠØ§Ù„/Ø¯ÙˆÙ„Ø§Ø±)</label>
    <input id="fxInput" type="number" inputmode="decimal" value="750" />

    <label>Ø§Ù„ÙØ¦Ø© Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠØ©</label>
    <div class="pill-group">
      <label class="pill"><input type="radio" id="rate5" name="rate" value="0.05" hidden>5%</label>
      <label class="pill"><input type="radio" id="rate10" name="rate" value="0.10" hidden>10%</label>
    </div>

    <div class="result" id="out">0</div>
    <div class="muted" id="formula">0 = 0 Ã— 0 Ã— 0 Ã— 0</div>

    <div style="margin-top:20px;text-align:center">
      <button class="btn btn-blue" onclick="copyResult()">Ù†Ø³Ø® Ø§Ù„Ù†ØªÙŠØ¬Ø©</button>
      <button class="btn btn-green" onclick="shareWhatsApp()">Ù…Ø´Ø§Ø±ÙƒØ© ÙˆØ§ØªØ³Ø§Ø¨</button>
    </div>
  </div>

<script>
// --- Ø§Ù„Ø­Ø³Ø§Ø¨ ---
const enFmt = new Intl.NumberFormat('en-US');
function formatYER(n){ return new Intl.NumberFormat('ar-YE',{maximumFractionDigits:0}).format(Math.round(n)); }

const usdInput=document.getElementById('usd');
const outEl=document.getElementById('out');
const formulaEl=document.getElementById('formula');
const rateRadios=document.querySelectorAll('input[name="rate"]');
const fxInput=document.getElementById('fxInput');
const pills=document.querySelectorAll('.pill');

function getRate(){
  const r=[...rateRadios].find(x=>x.checked);
  return r?parseFloat(r.value||0):0.05;
}
function getFx(){ const v=parseFloat(fxInput.value||0); return isFinite(v)&&v>0?v:750; }

function calc(){
  const usdVal=parseFloat(usdInput.value||0);
  const rate=getRate();
  const fx=getFx();
  const factor=0.2075; // Ù…Ø¹Ø§Ù…Ù„ Ø«Ø§Ø¨Øª
  const duty=usdVal*factor*fx*rate;
  outEl.textContent=formatYER(duty);
  formulaEl.textContent=`${enFmt.format(Math.round(duty))} = ${factor} Ã— ${fx} Ã— ${usdVal}`;
}
usdInput.addEventListener('input',calc);
fxInput.addEventListener('input',calc);
rateRadios.forEach((r,i)=>{
  r.addEventListener('change',()=>{
    pills.forEach(p=>p.classList.remove('active'));
    if(pills[i])pills[i].classList.add('active');
    calc();
  });
});

// Ù†Ø³Ø® ÙˆÙˆØ§ØªØ³Ø§Ø¨
function copyResult(){
  const t=`Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠØ©: ${outEl.textContent} Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ\n${formulaEl.textContent}`;
  navigator.clipboard.writeText(t).then(()=>alert('âœ” ØªÙ… Ø§Ù„Ù†Ø³Ø®'));
}
function shareWhatsApp(){
  const t=`Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠØ©: ${outEl.textContent} Ø±ÙŠØ§Ù„ ÙŠÙ…Ù†ÙŠ\n${formulaEl.textContent}`;
  window.open('https://wa.me/?text='+encodeURIComponent(t),'_blank');
}

// --- Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ù…Ù† URL ---
(function prefillFromURL(){
  const p=new URLSearchParams(location.search);
  const name=p.get('name');
  const price=p.get('price');
  const unit=p.get('unit');
  const qty=p.get('qty');
  const ratePercent=p.get('rate');
  const lock=p.get('lock')==='1';
  const nameEl=document.getElementById('name');
  const unitEl=document.getElementById('unit');
  const priceEl=document.getElementById('pricePerUnit');
  const qtyEl=document.getElementById('qty');
  if(name&&nameEl)nameEl.value=name;
  if(unit&&unitEl)unitEl.value=unit;
  if(price&&priceEl)priceEl.value=price;
  if(qty&&qtyEl)qtyEl.value=qty;
  if(price&&qty){
    const total=(parseFloat(price)||0)*(parseFloat(qty)||0);
    document.getElementById('usd').value=total;
  }
  // Ø¶Ø¨Ø· Ø§Ù„ÙØ¦Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§
  if(ratePercent){
    const val=parseFloat(ratePercent)/100;
    const r5=document.getElementById('rate5');
    const r10=document.getElementById('rate10');
    if(val===0.05&&r5){r5.checked=true;pills[0].classList.add('active');}
    if(val===0.10&&r10){r10.checked=true;pills[1].classList.add('active');}
    if(lock){
      if(r5)r5.disabled=true;
      if(r10)r10.disabled=true;
      pills.forEach(p=>p.style.pointerEvents='none');
    }
  }
  calc();
})();
</script>
</body>
</html>
